<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speed Reader - อ่านเร็วขึ้น</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts สำหรับภาษาไทย -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap">
    <style>
        :root {
            --primary-color: #0d6efd;
            --accent-color: #fd7e14;
            --highlight-color: #ff0019;
            --success-color: #1eff00;
            --navbar-height: 72px;
            
            /* สีสำหรับ navbar animation */
            --color-1: #4e54c8;
            --color-2: #8f94fb;
            --color-3: #bc4e9c;
            --color-4: #f80759;
            --color-5: #11998e;
            --color-6: #38ef7d;
        }

        .dark-mode {
            --bs-body-bg: #121212;
            --bs-body-color: #e0e0e0;
            --bs-card-bg: #1e1e1e;
            --bs-card-border-color: #333;
            --primary-color: #835ce7;
            --accent-color: #ff9f43;
            --highlight-color: #ff6b6b;
            --success-color: #00e676;
            
            /* สีพื้นหลังหลัก: #1E293B; /* Deep Charcoal */
            --color-1: #000000;
            /* สีพื้นหลังรอง/เน้น (Gradient Start): #374151; /* Slate Gray */
            --color-2: #028400;
            /* สีพื้นหลังส่วนประกอบ (Gradient End): #4B5563; /* Grayish Blue */
            --color-3: #0ac300;
            /* สีเน้นสำหรับแอนิเมชัน/โต้ตอบ (Bright Accent): #6EE7B7; /* Mint Green */
            --color-4: #00ff1e;
            /* สีข้อความหลัก (Light Text): #F9FAFB; /* Off-White */
            --color-5: #6aff00;
            /* สีเน้นข้อความ/สัญลักษณ์ (Subtle Accent): #A1A1AA; /* Medium Gray */
            --color-6: #eeff00;
        }

        body {
            font-family: 'Sarabun', sans-serif;
            transition: background-color 0.3s, color 0.3s;
            padding-top: var(--navbar-height); /* ให้พื้นที่สำหรับ navbar fixed-top */
        }

        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--navbar-height);
            z-index: 1030;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .navbar-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 200%;
            height: 100%;
            background: linear-gradient(
                90deg,
                var(--color-1),
                var(--color-2),
                var(--color-3),
                var(--color-4),
                var(--color-5),
                var(--color-6),
                var(--color-1)
            );
            animation: animateGradient 12s linear infinite;
            z-index: -1;
        }
        
        @keyframes animateGradient {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(-50%);
            }
        }
        
        .navbar-reading .navbar-bg {
            animation-duration: 6s !important; /* เร็วขึ้นเมื่อกำลังอ่าน */
        }
        
        /* สไตล์สำหรับทำให้ข้อความอ่านได้ง่ายเมื่ออยู่บน gradient */
        .navbar .navbar-brand, 
        .navbar .nav-link,
        .navbar .navbar-text,
        .navbar-toggler-icon {
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
        }

        .navbar-brand {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 700;
        }

        .navbar-brand i {
            font-size: 1.2rem;
        }

        .nav-link {
            font-weight: 500;
            position: relative;
            padding: 0.5rem 1rem;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: white;
            transition: width 0.3s ease;
        }

        .nav-link:hover::after {
            width: 100%;
        }

        .card {
            transition: background-color 0.3s, border-color 0.3s;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 1.5rem;
            border-radius: 0.75rem;
        }

        .dark-mode .card {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .display-word {
            font-size: 3rem;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 400;
            line-height: 1.3;
            padding: 10px;
        }

        .highlight {
            color: var(--highlight-color);
            font-weight: 700;
        }

        .btn-theme {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            transition: transform 0.3s ease, background 0.3s ease;
        }

        .btn-theme:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(30deg);
        }

        .timer {
            background-color: var(--accent-color);
            color: white;
            border-radius: 0.25rem;
            padding: 0.25rem 0.75rem;
            font-weight: bold;
            margin-left: 1rem;
        }

        @media (max-width: 768px) {
            .display-word {
                font-size: 2rem;
                min-height: 100px;
            }
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="navbar-bg"></div>
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-book-reader"></i>
                Speed Reader
            </a>
            <button id="theme-toggle" class="btn-theme">
                <i class="fas fa-sun text-white"></i>
            </button>
        </div>
    </nav>

    <div class="container py-4">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">ข้อความของคุณ</h5>
            </div>
            <div class="card-body">
                <textarea id="text-input" class="form-control mb-3" rows="4" 
                    placeholder="พิมพ์หรือวางข้อความที่นี่..."></textarea>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">การตั้งค่า</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label for="speed" class="form-label fw-bold">ความเร็ว (คำต่อนาที)</label>
                    <div class="d-flex align-items-center">
                        <input type="range" class="form-range me-3" id="speed" min="50" max="2000" step="10" value="300">
                        <span id="speed-value" class="badge bg-primary px-3 py-2">300</span>
                    </div>
                </div>

                <div class="d-flex flex-wrap gap-2">
                    <button id="start" class="btn btn-primary">
                        <i class="fas fa-play me-2"></i> เริ่มอ่าน
                    </button>
                    <button id="pause" class="btn btn-warning">
                        <i class="fas fa-pause me-2"></i> หยุดชั่วคราว
                    </button>
                    <button id="reset" class="btn btn-secondary">
                        <i class="fas fa-redo me-2"></i> เริ่มใหม่
                    </button>
                    <a href="index.html" id="goindex" class="btn btn-success">
                        <i class="fas fa-home me-2"></i> กลับไปที่การนับคำ
                    </a>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">หน้าจอการอ่าน</h5>
                <div id="timer" class="timer d-none">00:00</div>
            </div>
            <div class="card-body">
                <div id="display" class="display-word text-center">คำจะแสดงที่นี่</div>
                <div class="progress mt-3" style="height: 8px;">
                    <div id="progress-bar" class="progress-bar" role="progressbar" style="width: 0%"></div>
                </div>
                <div class="d-flex justify-content-between mt-2 text-muted small">
                    <span id="current-word">0</span>
                    <span id="total-words">0 คำ</span>
                </div>
            </div>
        </div>

        <div class="card" id="tips">
            <div class="card-header">
                <h5 class="mb-0">เคล็ดลับการอ่านเร็ว</h5>
            </div>
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">การฝึกอ่านแบบนี้ทุกวัน วันละ 10-15 นาทีจะช่วยเพิ่มความเร็วในการอ่านของคุณอย่างเห็นได้ชัด</li>
                    <li class="list-group-item">เริ่มด้วยความเร็วที่คุณสบาย แล้วค่อยๆ เพิ่มขึ้นทีละ 50 คำต่อนาที</li>
                    <li class="list-group-item">พยายามไม่อ่านออกเสียงในใจ (subvocalization) เพื่อเพิ่มความเร็ว</li>
                    <li class="list-group-item">หลังจากอ่านเสร็จ ลองทบทวนว่าคุณเข้าใจเนื้อหาได้มากน้อยเพียงใด</li>
                </ul>
            </div>
        </div>

        <div class="card" id="about">
            <div class="card-header">
                <h5 class="mb-0">เกี่ยวกับโปรแกรม</h5>
            </div>
            <div class="card-body">
                <p class="mb-0">Speed Reader เป็นเครื่องมือออนไลน์ที่ช่วยให้คุณฝึกการอ่านเร็วผ่านการแสดงคำทีละคำ เทคนิคนี้ช่วยเพิ่มความเร็วในการอ่านและความเข้าใจ เหมาะสำหรับนักเรียน นักศึกษา และผู้ที่ต้องการพัฒนาทักษะการอ่าน</p>
            </div>
        </div>
    </div>

    <footer class="py-3 text-center text-muted">
        <div class="container">
            <p class="mb-0">Speed Reader © 2025 - อ่านเร็วขึ้น เรียนรู้มากขึ้น</p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ตัวแปรสำหรับองค์ประกอบ UI
            const startButton = document.getElementById('start');
            const pauseButton = document.getElementById('pause');
            const resetButton = document.getElementById('reset');
            const speedSlider = document.getElementById('speed');
            const speedValue = document.getElementById('speed-value');
            const textInput = document.getElementById('text-input');
            const displayArea = document.getElementById('display');
            const progressBar = document.getElementById('progress-bar');
            const currentWordElement = document.getElementById('current-word');
            const totalWordsElement = document.getElementById('total-words');
            const themeToggle = document.getElementById('theme-toggle');
            const timerElement = document.getElementById('timer');
            const navbar = document.querySelector('.navbar');

            // ตัวแปรสำหรับการจัดการข้อความและการอ่าน
            let words = [];
            let currentWordIndex = 0;
            let isPlaying = false;
            let timerId;
            let isDarkMode = false;

            // ตัวแปรสำหรับระบบจับเวลา
            let startTime;
            let elapsedTime = 0;
            let timerInterval;

            // Smooth scrolling สำหรับการกดลิงก์ใน navbar
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        e.preventDefault();
                        const navbarHeight = navbar.offsetHeight;
                        window.scrollTo({
                            top: target.offsetTop - navbarHeight - 16, // คำนวณระยะห่างอัตโนมัติตามความสูงของ navbar
                            behavior: 'smooth'
                        });
                    }
                });
            });

            // ฟังก์ชันสำหรับการสลับธีม
            themeToggle.addEventListener('click', function() {
                document.body.classList.toggle('dark-mode');
                isDarkMode = document.body.classList.contains('dark-mode');
                themeToggle.innerHTML = isDarkMode ? 
                    '<i class="fas fa-moon text-white"></i>' : 
                    '<i class="fas fa-sun text-white"></i>';
                localStorage.setItem('darkMode', isDarkMode);
            });

            // โหลดการตั้งค่าธีมจาก localStorage
            if (localStorage.getItem('darkMode') === 'true') {
                document.body.classList.add('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-moon text-white"></i>';
                isDarkMode = true;
            }

            // อัพเดทการแสดงค่าความเร็ว
            speedSlider.addEventListener('input', function() {
                speedValue.textContent = speedSlider.value;
                if (isPlaying) {
                    pauseReading();
                    startReading();
                }
            });

            // ฟังก์ชันสำหรับการเริ่มอ่าน
            startButton.addEventListener('click', function() {
                if (!isPlaying) {
                    startReading();
                    startTimer();
                    navbar.classList.add('navbar-reading');
                }
            });

            // ฟังก์ชันสำหรับการหยุดชั่วคราว
            pauseButton.addEventListener('click', function() {
                if (isPlaying) {
                    pauseReading();
                    pauseTimer();
                    navbar.classList.remove('navbar-reading');
                }
            });

            // ฟังก์ชันสำหรับการเริ่มใหม่
            resetButton.addEventListener('click', function() {
                resetReading();
                resetTimer();
                navbar.classList.remove('navbar-reading');
            });

            // อัพเดทข้อความเมื่อมีการแก้ไข
            textInput.addEventListener('input', function() {
                resetReading();
                resetTimer();
                processText();
                updateWordCount();
            });

            // ฟังก์ชันเริ่มอ่าน
            function startReading() {
                if (currentWordIndex >= words.length) {
                    resetReading();
                }

                if (words.length === 0) {
                    processText();
                }

                if (words.length === 0) return;

                isPlaying = true;
                let speed = parseInt(speedSlider.value);
                let interval = 60000 / speed; // แปลง WPM เป็นมิลลิวินาที

                timerId = setInterval(function() {
                    if (currentWordIndex < words.length) {
                        displayWord(words[currentWordIndex]);
                        updateProgress();
                        currentWordIndex++;
                    } else {
                        pauseReading();
                        pauseTimer();
                        displayArea.innerHTML = '<span class="text-success">เสร็จสิ้น! 🎉</span>';
                    }
                }, interval);
            }

            // ฟังก์ชันหยุดอ่านชั่วคราว
            function pauseReading() {
                clearInterval(timerId);
                isPlaying = false;
            }

            // ฟังก์ชันรีเซ็ตการอ่าน
            function resetReading() {
                pauseReading();
                currentWordIndex = 0;
                updateProgress();
                displayArea.textContent = "คำจะแสดงที่นี่";
            }

            // ฟังก์ชันประมวลผลข้อความ
            function processText() {
                const text = textInput.value.trim();
                if (text) {
                    // ใช้ Intl.Segmenter สำหรับภาษาไทย ถ้ามี
                    if (window.Intl && Intl.Segmenter) {
                        try {
                            const segmenter = new Intl.Segmenter('th', { granularity: 'word' });
                            words = Array.from(segmenter.segment(text))
                                .filter(seg => seg.segment.trim().length > 0)
                                .map(seg => seg.segment);
                        } catch (e) {
                            // Fallback ถ้า Segmenter ไม่รองรับ
                            fallbackTextProcessing(text);
                        }
                    } else {
                        fallbackTextProcessing(text);
                    }
                    updateWordCount();
                } else {
                    words = [];
                    updateWordCount();
                }
            }
            
            // Fallback สำหรับการประมวลผลข้อความถ้า Intl.Segmenter ไม่รองรับ
            function fallbackTextProcessing(text) {
                // แยกด้วยช่องว่างและอักขระพิเศษ
                const splitPattern = /[\s\.\,\;\:\!\?\(\)\[\]\{\}\"\'\-\+\=\_\<\>\/\|\\\~\`\@\#\$\%\^\\&\*]+/;
                words = text.split(splitPattern).filter(word => word.length > 0);
            }

            // อัพเดทจำนวนคำ
            function updateWordCount() {
                totalWordsElement.textContent = words.length + ' คำ';
                currentWordElement.textContent = '0';
            }

            // อัพเดทความคืบหน้าการอ่าน
            function updateProgress() {
                if (words.length === 0) {
                    progressBar.style.width = '0%';
                    currentWordElement.textContent = '0';
                    return;
                }
                
                const progress = (currentWordIndex / words.length) * 100;
                progressBar.style.width = progress + '%';
                currentWordElement.textContent = currentWordIndex;
            }

            // แสดงคำปัจจุบัน
            function displayWord(word) {
                if (!word || word.length === 0) {
                    displayArea.textContent = "";
                    return;
                }
                
                // เน้นตัวอักษรตรงกลางของคำ
                let orp = Math.max(1, Math.floor(word.length / 3));
                const pre = word.substring(0, orp);
                const highlight = word.substring(orp, orp + 1);
                const post = word.substring(orp + 1);
                displayArea.innerHTML = pre + '<span class="highlight">' + highlight + '</span>' + post;
            }

            // ฟังก์ชันสำหรับระบบจับเวลา
            function startTimer() {
                timerElement.classList.remove('d-none');
                if (!startTime) {
                    startTime = Date.now() - elapsedTime;
                }
                timerInterval = setInterval(updateTimer, 1000);
            }

            function pauseTimer() {
                clearInterval(timerInterval);
                elapsedTime = Date.now() - startTime;
            }

            function resetTimer() {
                clearInterval(timerInterval);
                timerElement.textContent = "00:00";
                timerElement.classList.add('d-none');
                startTime = null;
                elapsedTime = 0;
            }

            function updateTimer() {
                const currentTime = Date.now();
                elapsedTime = currentTime - startTime;
                
                // แปลงเป็นรูปแบบ นาที:วินาที
                const minutes = Math.floor(elapsedTime / 60000);
                const seconds = Math.floor((elapsedTime % 60000) / 1000);
                
                timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }

            // เริ่มต้นเมื่อโหลดหน้าเว็บ
            processText();
            updateWordCount();
        });
    </script>
</body>

</html>